var HEIGHT,WIDTH,draw,fillScale,getSentimentForWord,inited,parentWidth,redraw,scaleColors,sizeScale,wordData;parentWidth=$("svg#cloud").parent().width(),WIDTH=parentWidth,HEIGHT=parentWidth/2,wordData=[],inited=!1,getSentimentForWord=function(t){var r,e,a;for(e=0,a=wordData.length;a>e;e++)if(r=wordData[e],r.word===t)return r.sentiment;return 0},scaleColors=["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#B4B4B4","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],fillScale=d3.scale.linear().domain([-1,-.8,-.6,-.4,-.2,0,.2,.4,.6,.8,1]).range(scaleColors),sizeScale=d3.scale.linear().domain([0,80]).range([13,65]),draw=function(t){return d3.select("svg#cloud").attr("width",WIDTH).attr("height",HEIGHT).append("g")},redraw=function(t){return d3.select("svg#cloud g").attr("transform","translate(150,150)").selectAll("text").data(t).enter().append("text").style("font-family","Impact").style("fill",function(t,r){return fillScale(getSentimentForWord(t.word))}).attr("text-anchor","middle").attr("transform",function(t){return"translate("+[t.x,t.y]+")rotate("+t.rotate+")"}).text(function(t){return t.word})},$(function(){var t;return t=d3.layout.cloud().size([WIDTH,HEIGHT]).words(wordData).rotate(function(){return~~(45*Math.round(5*Math.random()))-90}).font("Impact").fontSize(function(t){return sizeScale(t.size)}).on("end",draw).start(),window.updateCloud=function(r){var e,a,n,o;if(e=wordData.filter(function(t){return t.word===r.word}),0===e.length)wordData.push({word:r.word,sentiment:r.sentiment,size:1});else for(a=0,n=wordData.length;n>a;a++)o=wordData[a],o.word===r.word&&o.size++;return t.words(wordData).on("end",redraw).start(),wordData}});
/* (C) Alicia Sykes <aliciasykes.com> MIT License. */